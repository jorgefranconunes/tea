###########################################################################
#
# Copyright (c) 2011-2012 PDMFC, All Rights Reserved.
#
#
# TUnit tests for functions in the tea.string module.
#
###########################################################################





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-printf-test {

    tunit-test printfOk {
        tunit-assert-equals "Hello" [str-printf "Hello"]
    }

    tunit-test-error tooFewArgs {
        str-printf
    }

    tunit-test-error invalidArgType {
        str-printf 1
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-fmt-test {

    tunit-test fmtOk {
        tunit-assert-equals "Hello" [str-fmt "Hello"]
    }

    tunit-test-error tooFewArgs {
        str-fmt
    }

    tunit-test-error invalidArgType {
        str-fmt 1
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-upper-test {

    tunit-test upperOk {
        tunit-assert-equals "HELLO" [str-upper "hello"] 
    }

    tunit-test-error tooFewArgs {
        str-upper
    }

    tunit-test-error tooManyArgs {
        str-upper "too" "many" "args"
    }

    tunit-test-error invalidArgType {
        str-upper 1
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-lower-test {

    tunit-test lowerOk {
        tunit-assert-equals "hello" [str-lower "HELLO"]
    }

    tunit-test-error tooFewArgs {
        str-lower
    }

    tunit-test-error tooManyArgs {
        str-lower "too" "many" "args"
    }

    tunit-test-error invalidArgType {
        str-lower 1
    }

}





###########################################################################
#
# Utility function for creating testsuits for string comparison
# functions.
#
###########################################################################

define build-string-comparison-testsuit \
        ( testSuitName teaFunction ltValue eqValue gtValue ) {

    tunit-testsuite $testSuitName {

        tunit-test cmpLt {
            tunit-assert-equals $ltValue [$teaFunction "a" "b"]
        }

        tunit-test cmpEq {
            tunit-assert-equals $eqValue [$teaFunction "a" "a"]
        }

        tunit-test cmpGt {
            tunit-assert-equals $gtValue [$teaFunction "b" "a"]
        }

        tunit-test-error tooFewArgs0 {
            $teaFunction
        }

        tunit-test-error tooFewArgs1 {
            $teaFunction "a"
        }

        tunit-test-error tooManyArgs {
            $teaFunction "too" "many" "args"
        }

        tunit-test-error invalidArgType {
            $teaFunction "a" 1
        }

    }
}





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str-cmp-test \
        $str-cmp \
        -1 \
        0 \
        1





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str>-test \
        $str> \
        $false \
        $false \
        $true





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str>=-test \
        $str>= \
        $false \
        $true \
        $true





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str==-test \
        $str== \
        $false \
        $true \
        $false





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str!=-test \
        $str!= \
        $true \
        $false \
        $true





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str<-test \
        $str< \
        $true \
        $false \
        $false





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str<=-test \
        $str<= \
        $true \
        $true \
        $false





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-cat-test {

    tunit-test catOk1 {
        tunit-assert-equals "Hello" [str-cat "Hello"]
    }

    tunit-test catOk2 {
        tunit-assert-equals "HelloWorld" [str-cat "Hello" "World"]
    }

    tunit-test-error tooFewArgs {
        str-cat
    }

    tunit-test-error invalidArgType1 {
        str-cat 1
    }

    tunit-test-error invalidArgType2 {
        str-cat "Hello" 2
    }

}





###########################################################################
#
# 
#
###########################################################################

