###########################################################################
#
# Copyright (c) 2011-2012 PDMFC, All Rights Reserved.
#
#
# TUnit tests for functions in the tea.string module.
#
###########################################################################





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-printf-test {

    tunit-test printfOk {
        tunit-assert-equals "Hello" [str-printf "Hello"]
    }

    tunit-test-error tooFewArgs {
        str-printf
    }

    tunit-test-error invalidArgType {
        str-printf 1
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-fmt-test {

    tunit-test fmtOk {
        tunit-assert-equals "Hello" [str-fmt "Hello"]
    }

    tunit-test-error tooFewArgs {
        str-fmt
    }

    tunit-test-error invalidArgType {
        str-fmt 1
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-upper-test {

    tunit-test upperOk {
        tunit-assert-equals "HELLO" [str-upper "hello"] 
    }

    tunit-test-error tooFewArgs {
        str-upper
    }

    tunit-test-error tooManyArgs {
        str-upper "too" "many" "args"
    }

    tunit-test-error invalidArgType {
        str-upper 1
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-lower-test {

    tunit-test lowerOk {
        tunit-assert-equals "hello" [str-lower "HELLO"]
    }

    tunit-test-error tooFewArgs {
        str-lower
    }

    tunit-test-error tooManyArgs {
        str-lower "too" "many" "args"
    }

    tunit-test-error invalidArgType {
        str-lower 1
    }

}





###########################################################################
#
# Utility function for creating testsuits for string comparison
# functions.
#
###########################################################################

define build-string-comparison-testsuit \
        ( testSuitName teaFunction ltValue eqValue gtValue ) {

    tunit-testsuite $testSuitName {

        tunit-test cmpLt {
            tunit-assert-equals $ltValue [$teaFunction "a" "b"]
        }

        tunit-test cmpEq {
            tunit-assert-equals $eqValue [$teaFunction "a" "a"]
        }

        tunit-test cmpGt {
            tunit-assert-equals $gtValue [$teaFunction "b" "a"]
        }

        tunit-test-error tooFewArgs0 {
            $teaFunction
        }

        tunit-test-error tooFewArgs1 {
            $teaFunction "a"
        }

        tunit-test-error tooManyArgs {
            $teaFunction "too" "many" "args"
        }

        tunit-test-error invalidArgType {
            $teaFunction "a" 1
        }

    }
}





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str-cmp-test \
        $str-cmp \
        -1 \
        0 \
        1





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str>-test \
        $str> \
        $false \
        $false \
        $true





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str>=-test \
        $str>= \
        $false \
        $true \
        $true





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str==-test \
        $str== \
        $false \
        $true \
        $false





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str!=-test \
        $str!= \
        $true \
        $false \
        $true





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str<-test \
        $str< \
        $true \
        $false \
        $false





###########################################################################
#
# 
#
###########################################################################

build-string-comparison-testsuit \
        str<=-test \
        $str<= \
        $true \
        $true \
        $false





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-cat-test {

    tunit-test catOk1 {
        tunit-assert-equals "Hello" [str-cat "Hello"]
    }

    tunit-test catOk2 {
        tunit-assert-equals "HelloWorld" [str-cat "Hello" "World"]
    }

    tunit-test-error tooFewArgs {
        str-cat
    }

    tunit-test-error invalidArgType1 {
        str-cat 1
    }

    tunit-test-error invalidArgType2 {
        str-cat "Hello" 2
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-ends-with?-test {

    tunit-test endsWithTrue {
        tunit-assert-equals $true [str-ends-with? "HelloWorld" "World"]
    }

    tunit-test endsWithFalse {
        tunit-assert-equals $false [str-ends-with? "HelloWorld" "Hello"]
    }

    tunit-test-error tooFewArgs0 {
        str-ends-with?
    }

    tunit-test-error tooFewArgs1 {
        str-ends-with? "Hello"
    }

    tunit-test-error tooManyArgs {
        str-ends-with? "too" "many" "args"
    }

    tunit-test-error invalidArgType1 {
        str-ends-with? 1 "World"
    }

    tunit-test-error invalidArgType2 {
        str-ends-with? "Hello" 2
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-starts-with?-test {

    tunit-test startsWithTrue {
        tunit-assert-equals $true [str-starts-with? "HelloWorld" "Hello"]
    }

    tunit-test startsWithFalse {
        tunit-assert-equals $false [str-starts-with? "HelloWorld" "World"]
    }

    tunit-test-error tooFewArgs0 {
        str-starts-with?
    }

    tunit-test-error tooFewArgs1 {
        str-starts-with? "Hello"
    }

    tunit-test-error tooManyArgs {
        str-starts-with? "too" "many" "args"
    }

    tunit-test-error invalidArgType1 {
        str-starts-with? 1 "World"
    }

    tunit-test-error invalidArgType2 {
        str-starts-with? "Hello" 2
    }

}





###########################################################################
#
# 
#
###########################################################################

tunit-testsuite str-index-of-test {

    tunit-test indexOf1 {
        tunit-assert-equals 5 [str-index-of "HelloWorld" "World"]
    }

    tunit-test indexOf2 {
        tunit-assert-equals -1 [str-index-of "HelloWorld" "What?"]
    }

    tunit-test indexOf3 {
        tunit-assert-equals 10 [str-index-of "HelloWorldHello" "Hello" 6]
    }

    tunit-test-error tooFewArgs0 {
        str-index-of
    }

    tunit-test-error tooFewArgs1 {
        str-index-of "Hello"
    }

    tunit-test-error tooManyArgs {
        str-index-of "too" "many" "args" "for" "sure"
    }

    tunit-test-error invalidArgType1 {
        str-index-of 1 "World"
    }

    tunit-test-error invalidArgType2 {
        str-index-of "Hello" 2
    }

    tunit-test-error invalidArgType3 {
        str-index-of "Hello" "World" "What?!"
    }

}





###########################################################################
#
# 
#
###########################################################################

