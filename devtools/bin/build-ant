#!/bin/bash
###########################################################################
#
# Copyright (c) 2010 PDM&FC, All Rights Reserved.
#
#
# Invokes the Ant tool with the apropriate JVM and classpath.
#
#########################################################################

_scriptDir=$(dirname $0)
_scriptName=$(basename $0)
_teaBaseDir=$(cd $_scriptDir/../.. >/dev/null; pwd)

#
# Make utility functions available
#
source ${_teaBaseDir}/bin/tea-utils





#
# The following will have to be adapted whenever a new version of
# theses packages is used.
#
_defaultAntToolBasename=devtools/apache-ant-1.8.0/bin/ant
_defaultAntSetupTool=devtools/bin/build-configure
_buildConf=${_teaBaseDir}/Makefile.conf

if [ -f ${_buildConf} ] ; then
    source ${_buildConf}
else
    teaError "File \"${_buildConf}\" is missing..."
fi

_javaHome=${BUILD_JAVA_HOME}
_antTool=${BUILD_ANT}





#########################################################################
#
# 
#
#########################################################################

function setupConfig () {

    if [ -z "${_antTool}" ] ; then
        _antTool=${_teaBaseDir}/${_defaultAntToolBasename}
    fi
    if [ ! -f "${_antTool}" ] ; then
        ${_teaBaseDir}/${_defaultAntSetupTool}
    fi
}





#########################################################################
#
# Script main body
#
#########################################################################

setupConfig

JAVA_HOME=${_javaHome} \
${_antTool} \
    "$@"





#########################################################################
#
# 
#
#########################################################################

